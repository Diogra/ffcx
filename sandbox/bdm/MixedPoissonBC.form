# Copyright (C) 2007 Marie Rognes (meg@math.uio.no)"
# Licensed under the GNU GPL version 3 or any later version
#
# The bilinear form a(v, u) and linear form L(v) for a mixed
# formulation of Poisson's equation with non-homogenous boundary
# conditions, namely:
#             - div grad u = f
#             u(x) = g(x) for x on (parts of) boundary


# Compile this form with FFC: ffc MixedPoissonBC.form

q = 1
shape = "triangle"

BDM = FiniteElement("Brezzi-Douglas-Marini", shape, q)
DG  = FiniteElement("Discontinuous Lagrange", shape, q - 1)

mixed_element = BDM + DG

(tau, w) = TestFunctions(mixed_element)
(sigma, u) = TrialFunctions(mixed_element)
f = Function(DG) 
g = Function(DG) 
n = FacetNormal(shape)

a = (dot(tau, sigma) - div(tau)*u + w*div(sigma))*dx
L = w*f*dx - dot(tau, n)*g*ds
