# Copyright (C) 2006 Anders Logg (logg@simula.no)
# Licensed under the GNU GPL Version 2
#
# The bilinear form a(v, U) and linear form L(v) for
# a mixed formulation of Poisson's equation with BDM
# (Brezzi-Douglas-Marini) elements.

# Compile this form with FFC: ffc MixedPoisson.form

print "*** This demo does not work yet, I'm working on it..."
dev = False

if dev:

    q = 1

    BDM = FiniteElement("Brezzi-Douglas-Marini", "triangle", q)
    DG  = FiniteElement("Discontinuous Lagrange", "triangle", q - 1)

    mixed_element = BDM + DG
    
    (v, w) = TestFunctions(mixed_element)
    (Q, U) = TrialFunctions(mixed_element)
    
    a = (dot(v, Q) - div(v)*U + w*div(Q))*dx
    L = w*f*dx

else:

    element = FiniteElement("Lagrange", "triangle", 1)
    v = BasisFunction(element)
    L = v*dx
